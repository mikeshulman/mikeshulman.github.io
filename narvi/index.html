<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Narvi</title>
    <link rel="stylesheet" href="styles.css">
    <script src=" https://cdn.jsdelivr.net/npm/interactjs@1.10.27/dist/interact.min.js "></script>
    <script src="narvi.bc.js"></script>
</head>
<body>
    <div id="palette">
        <div class="basic intro rule" id="andI" data-rule="andI">‚àß</div>
        <div class="basic elim rule" id="andE" data-rule="andE">‚àß</div>
        <div class="basic intro rule" id="orI1" data-rule="orI1">‚à®<sub>L</sub></div>
        <div class="basic intro rule" id="orI2" data-rule="orI2">‚à®<sub>R</sub></div>
        <div class="container rule" id="orE" data-rule="orE">
          <div class="mid bar"></div>
          <div class="doubleleft assumption"><div class="subgoallabel">‚à®</div></div>
          <div class="doubleright subgoal"></div>
          <div class="mid midleft"></div>
          <div class="mid midright"></div>
        </div>
        <div class="container rule" id="impI" data-rule="impI">
          <div class="bottom bar"></div>
          <div class="singleleft assumption"></div>
          <div class="singleright subgoal"><div class="subgoallabel">‚áí</div></div>
          <div class="bottomleft"></div>
          <div class="bottomright"></div>
        </div>
        <div class="basic elim rule" id="impE" data-rule="impE">‚áí</div>
        <div class="container rule" id="iffI" data-rule="iffI">
          <div class="mid bar"></div>
          <div class="doubleleft assumption"></div>
          <div class="doubleright subgoal"><div class="subgoallabel">‚áî</div></div>
          <div class="mid midleft"></div>
          <div class="mid midright"></div>
        </div>
        <div class="basic elim rule" id="iffE1" data-rule="iffE1">‚áî<sub>L‚ÜíR</sub></div>
        <div class="basic elim rule" id="iffE2" data-rule="iffE2">‚áî<sub>R‚ÜíL</sub></div>
        <div class="basic intro rule" id="exI" data-rule="exI"> ‚àÉ</div>
        <div class="basic elim rule" id="exE" data-rule="exE">‚àÉ</div>
        <div class="container rule" id="allI" data-rule="allI">
          <div class="bottom bar"></div>
          <div class="singleleft assumption"></div>
          <div class="singleright subgoal"><div class="subgoallabel">‚àÄ</div></div>
          <div class="bottomleft"></div>
          <div class="bottomright"></div>
        </div>
        <div class="basic elim rule" id="allE" data-rule="allE">‚àÄ</div>
        <div class="basic elim rule" id="negE" data-rule="negE">¬¨</div>
        <div class="container rule" id="negI" data-rule="negI">
          <div class="bottom bar"></div>
          <div class="singleleft assumption"></div>
          <div class="singleright subgoal"><div class="subgoallabel">¬¨</div></div>
          <div class="bottomleft"></div>
          <div class="bottomright"></div>
        </div>
        <div class="container rule" id="negnegI" data-rule="negnegI">
          <div class="bottom bar"></div>
          <div class="singleleft assumption" style="width:27px"><div class="assumptionlabel">¬¨</div></div>
          <div class="singleright subgoal"></div>
          <div class="bottomleft"></div>
          <div class="bottomright"></div>
        </div>
        <div class="basic rule" style="text-align: left" id="botE" data-rule="botE">‚ä•</div>
        <div class="basic rule" style="text-align: right" id="topI" data-rule="topI">‚ä§</div>
        <!-- <div class="basic rule" style="text-align: center" id="asc" data-rule="asc">üè∑</div> -->
        <div style="position: absolute; bottom: 10px" id="buttons"><button id="selectLevel">Select Level</button></div>
    </div>
    <div id="diagram"></div>

    <div id="currentLevel"></div>

    <div id="levelChooseBG" class="modalbg">
      <div class="modal" id="levelChooseModal">
        <div style="text-align: center; font-size: 24px; display: grid; grid-template-columns: 1fr 20px 500px 20px 1fr; margin-bottom: 20px">
          <div></div>
          <div id="backWorld" style="cursor: pointer">‚óÄ</div>
          <div id="worldName">Select a level</div>
          <div id="forwardWorld" style="cursor: pointer">‚ñ∂</div>
          <div></div>
        </div>
        <p id="chooseLevelWarning" style="display: none; text-align: center">(Choosing a new level clears any existing proof)</p>
        <div id="worlds">
        </div>
        <div style="text-align: center; margin-top: 30px">
          <button id="cancelChooseLevel" style="font-size: 16px; display: none">Cancel</button>
          <button id="clearHistory" style="font-size: 16px">Clear History</button>
          <button id="about" style="font-size: 16px">About</button>
          <br/>
        </div>
      </div>
    </div>

    <div id="levelSelectBG" class="modalbg">
      <div class="modal">
        <h3 style="text-align: center">What do you want to prove?</h3>
        <span id="setLevelWarning" style="display: none">(Choosing a new level clears any existing proof)</span>
        <p>Parameters, with types (one per line):</p>
        <textarea id="parameters" style="width: 100%" rows="3"></textarea>
        <div id="paramPalette"></div>
        <p>Variables, with types (one per line):</p>
        <textarea id="variables" style="width: 100%" rows="3"></textarea>
        <div id="varPalette"></div>
        <p>Hypotheses (one per line):</p>
        <textarea id="hypotheses" style="width: 100%" rows="3"></textarea>
        <div id="hypPalette"></div>
        <p>Conclusion:</p>
        <input type="text" id="conclusion" style="width: 100%; font-family: monospace"/>
        <div id="conclPalette"></div>
        <div style="text-align: center; margin-top: 30px">
          <button id="submitLevel" style="font-size: 16px">Submit</button>
          <button id="backLevel" style="font-size: 16px">Back</button>
          <button id="cancelSetLevel" style="font-size: 16px; display: none">Cancel</button><br/>
        </div>
      </div>
    </div>

    <div id="variableBG" class="modalbg">
      <div class="modal">
        <h3 style="text-align: center">Choose a new variable name</h3>
        <p>Variables currently in use:</p>
        <div id="variableList"></div>
        <p>New variable:</p>
        <input type="text" id="newvar" style="width: 100%"/>
        <div style="text-align: center; margin-top: 30px">
          <button id="submitVariable" style="font-size: 16px">Submit</button><br/>
        </div>
      </div>
    </div>

    <div id="ascribeBG" class="modalbg">
      <div class="modal">
        <h3 style="text-align: center">Ascribe a wire</h3>
        <p>Ascribe this wire to the following:</p>
        <input type="text" id="ascribe" style="width: 100%"/>
        <div style="text-align: center; margin-top: 30px">
          <button id="submitAscribe" style="font-size: 16px">Submit</button><br/>
        </div>
      </div>
    </div>

    <div id="aboutBG" class="modalbg">
      <div class="modal" style="width: 1000px; height: 800px; background-color: #cccccc">
        <h1 style="text-align: center">Welcome to Narvi!</h1>
        <div style="height: 650px; overflow-y: scroll; background-color: #ffffff; padding: 10px">
          <h2>What is Narvi?</h2>
          <p class="about">
            Narvi is a game where you prove abstract theorems in classical predicate logic by connecting boxes with wires.
            It's a fun collection of puzzles, and also an educational tool for learning to write proofs.
            There are over a hundred levels, divided into three worlds of propositional logic, quantifiers, and negation, each with several stages.
            There is no requirement that you do the levels in order; you can skip around, but when learning I recommend you proceed mostly in order.
          </p>
          <h2>How do the graphs work?</h2>
          <p class="about">
            In each level you have some number (perhaps zero) of "assumptions" or "givens" that appear in boxes on the left, and one desired "conclusion" appearing in a box on the right.
            Your goal is to connect the assumptions to the conclusion: logic flows from left to right.
          </p>
          <p class="about">
            You can add new boxes to the graph by dragging and dropping them from the "palette" bar on the left; more options will be added to the palette as you progress through the levels.
            Each box has some number of "output ports" on the right and "input ports" on the left.
            You can drag a connection from any output port to any input port, as long as they are labeled by the same statement or value.
            Not every output port needs to be used, but every input port must have something coming into it for the proof to be correct.
            Some boxes also give you "local assumptions" that act like output ports, but can only be used to prove the corresponding "subgoal" input port.
          </p>
          <p class="about">
            When your proof checks, the conclusion will turn green, as will that level in the level-selection dialog.
            Unconnected input ports, and incorrectly connected wires, are colored red.
            Wires carrying "values" rather than truth are colored blue.
          </p>
          <h2>Where do these graphs come from?</h2>
          <p class="about">
            Many people have represented proofs graphically, starting with Charles Sanders Peirce, one of the inventors of predicate logic.
            More recently, the physicist Roger Penrose introduced string diagrams for tensors, mathematicians such as Andre Joyal and Ross Street formalized them to describe monoidal categories, and the logician Jean-Yves Girard introduced proof nets for linear logic.
            The specific style of graphical proofs used by Narvi is based heavily on the graphs used by <a href="https://incredible.pm/">The Incredible Proof Machine</a> by Joachim Breitner, but enhanced with value-carrying wires for predicate logic.
          </p>
          <h2>What's under the hood?</h2>
          <p class="about">
            The underlying proof-checker of Narvi is <a href="https://github.com/mikeshulman/narya">Narya</a>.
            Narya is an experimental proof assistant for higher-dimensional dependent type theory such as higher observational type theory (a form of homotopy type theory), internally parametric type theory, and displayed type theory.
            Narvi doesn't currently use very much of the power of Narya, but in principle it could be extended to be a full-fledged graphical proof assistant for dependent type theory using the same core.
          </p>
          <p class="about">
            Narya is written in OCaml, which through the magic of <tt>js_of_ocaml</tt> is compiled to run in your browser underneath Narvi.
            If you'd like to try Narya directly, its ordinary interactive mode is also available in your browser as <a href="https://mikeshulman.github.io/jsnarya/">jsNarya</a>.
            If Narvi and jsNarya whet your appetite, you can download the full Narya proof assistant to run locally on your computer from its <a href="https://github.com/mikeshulman/narya">github page</a>.
          </p>
          <h2>Narya? Narvi?</h2>
          <p class="about">
            Narya is the third elven-ring in J.R.R. Tolkien's Legendarium: the ring of fire, that was given by C&iacute;rdan the Shipwright to Gandalf when he arrived in Middle-Earth.
            Narvi was a dwarven craftsman who, together with Celebrimbor, made the Doors of Durin at the West-gate of Moria.
          </p>
          <h2>Who wrote all this?</h2>
          <p class="about">
            Mike Shulman, a mathematician at the University of San Diego.
            <a href="https://home.sandiego.edu/~shulman/">Here's</a> my web page.
            Send me your questions, suggestions, complaints, and other thoughts!
            I look forward to hearing from you.
          </p>
        </div>
        <div style="text-align: center; margin-top: 30px">
          <button id="doneAbout" style="font-size: 16px">Back</button><br/>
        </div>
      </div>
    </div>

    <script src="bundle.js"></script>
</body>
</html>
